<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Library</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>

    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.css">
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.3.1/js/dataTables.buttons.min.js"></script> 
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.3.1/js/buttons.html5.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"></script>  

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/a8a7e5877e.js" crossorigin="anonymous"></script>

    <script src="controller.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css">

    <script>
        var Today = new Date();
        var Tyear = Today.getFullYear(); 
        outstr = "<option value='" + 2013 + "'>2013</option>";
        for(var year = 2017;year < Tyear;year ++){
            outstr += "<option value ='" + year + "'>" + year + "</option>";
        }
        outstr += "<option selected value ='" + Tyear + "'>" + Tyear + "</option>";
    </script>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <h2 class="navbar-brand" id="status"></h2>
        <h3 class="navbar-brand">電子書使用統計</h3>
    </nav><br>
    <div class="container">
        <div class="row">
            <div class="col">
                <form name="form" action="page.html?year" method="get">
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                          <span class="input-group-text">選擇查詢年分:</span>
                        </div>
                        <select class="form-select" id="year" name="year" onChange="saveValue(this);">
                            <script> 
                                document.write(outstr)
                            </script>
                        </select>
                        <div class="input-group-prepend">
                            <button class="btn btn-primary" type='submit' value="Submit">Search</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <div class="row">
            <table class="table" id="total">
                <tr class="table-info">
                  <th>Total</th>
                  <th>1月</th>
                  <th>2月</th>
                  <th>3月</th>
                  <th>4月</th>
                  <th>5月</th>
                  <th>6月</th>
                  <th>7月</th>
                  <th>8月</th>
                  <th>9月</th>
                  <th>10月</th>
                  <th>11月</th>
                  <th>12月</th>
                </tr>
                <tbody id="total_body">
                </tbody>
            </table>
        </div>
        <div class="chart-container">
            <canvas id="myChart"></canvas>
        </div>
        <div class="row">
            <div class="col">
                <table class="table table-striped" id="table_id13">
                    <thead>
                        <tr>
                            <th>總表格日期</th>
                            <th>總表格次數</th>
                        </tr>
                    </thead>
                    <tbody id="tbody_id13">
                    </tbody>
                </table>
            </div>
        </div>
        <div class="text-center">
            <h3 style="background-color:orange;font-weight: bold;">1~12月電子書使用次數細項</h3> 
        </div>
        <div class="row">
            <div class="col">
                <table class="table table-striped" id="table_id1">
                    <thead>
                        <tr>
                            <th>1月</th>
                            <th>次數</th>
                        </tr>
                    </thead>
                    <tbody id="tbody_id1">
                    </tbody>
                </table>
            </div>
            <div class="col">
                <table class="table table-striped" id="table_id2">
                    <thead>
                        <tr>
                            <th>2月</th>
                            <th>次數</th>
                        </tr>
                    </thead>
                    <tbody id="tbody_id2">
                    </tbody>
                </table>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <table class="table table-striped" id="table_id3">
                    <thead>
                        <tr>
                            <th>3月</th>
                            <th>次數</th>
                        </tr>
                    </thead>
                    <tbody id="tbody_id3">
                    </tbody>
                </table>
            </div>
            <div class="col">
                <table class="table table-striped" id="table_id4">
                    <thead>
                        <tr>
                            <th>4月</th>
                            <th>次數</th>
                        </tr>
                    </thead>
                    <tbody id="tbody_id4">
                    </tbody>
                </table>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <table class="table table-striped"id="table_id5">
                    <thead>
                        <tr>
                            <th>5月</th>
                            <th>次數</th>
                        </tr>
                    </thead>
                    <tbody id="tbody_id5">
                    </tbody>
                </table>
            </div>
            <div class="col">
                <table class="table table-striped" id="table_id6">
                    <thead>
                        <tr>
                            <th>6月</th>
                            <th>次數</th>
                        </tr>
                    </thead>
                    <tbody id="tbody_id6">
                    </tbody>
                </table>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <table class="table table-striped" id="table_id7">
                    <thead>
                        <tr>
                            <th>7月</th>
                            <th>次數</th>
                        </tr>
                    </thead>
                    <tbody id="tbody_id7">
                    </tbody>
                </table>
            </div>
            <div class="col">
                <table class="table table-striped" id="table_id8">
                    <thead>
                        <tr>
                            <th>8月</th>
                            <th>次數</th>
                        </tr>
                    </thead>
                    <tbody id="tbody_id8">
                    </tbody>
                </table>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <table class="table table-striped" id="table_id9">
                    <thead>
                        <tr>
                            <th>9月</th>
                            <th>次數</th>
                        </tr>
                    </thead>
                    <tbody id="tbody_id9">
                    </tbody>
                </table>
            </div>
            <div class="col">
                <table class="table table-striped" id="table_id10">
                    <thead>
                        <tr>
                            <th>10月</th>
                            <th>次數</th>
                        </tr>
                    </thead>
                    <tbody id="tbody_id10">
                    </tbody>
                </table>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <table class="table table-striped" id="table_id11">
                    <thead>
                        <tr>
                            <th>11月</th>
                            <th>次數</th>
                        </tr>
                    </thead>
                    <tbody id="tbody_id11">
                    </tbody>
                </table>
            </div>
            <div class="col">
                <table class="table table-striped" id="table_id12">
                    <thead>
                        <tr>
                            <th>12月</th>
                            <th>次數</th>
                        </tr>
                    </thead>
                    <tbody id="tbody_id12">
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <script>
        var Today = new Date();
        var Tyear = Today.getFullYear();

        document.getElementById('year').value = getSavedValue('year')
        function saveValue(e) {
            var id = e.id;
            var val = e.value;
            sessionStorage.setItem(id, val);
        }
        function getSavedValue(v) {
            if (!sessionStorage.getItem(v)) {
                return Tyear.toString();
            }
            return sessionStorage.getItem(v);
        }
    </script>
</body>
</html>